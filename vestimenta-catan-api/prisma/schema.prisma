generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model colores {
  id                 BigInt               @id @default(autoincrement())
  nombre             String               @unique
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  updated_at         DateTime             @default(now()) @db.Timestamptz(6)
  deleted_at         DateTime?            @db.Timestamptz(6)
  is_active          Boolean              @default(true)
  deleted_by         String?
  delete_reason      String?
  producto_variantes producto_variantes[]
  reservas           reservas[]

  @@index([is_active], map: "ix_colores_active")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model producto_variantes {
  id            BigInt    @id @default(autoincrement())
  producto_id   Int
  talle_id      BigInt?
  color_id      BigInt
  cantidad      Int       @default(0)
  created_at    DateTime  @default(now()) @db.Timestamptz(6)
  updated_at    DateTime  @default(now()) @db.Timestamptz(6)
  delete_reason String?
  deleted_at    DateTime? @db.Timestamptz(6)
  deleted_by    String?
  is_active     Boolean   @default(true)
  colores       colores   @relation(fields: [color_id], references: [id], onUpdate: NoAction, map: "fk_pv_color")
  productos     productos @relation(fields: [producto_id], references: [id], onUpdate: NoAction, map: "fk_pv_producto")
  talles        talles?   @relation(fields: [talle_id], references: [id], onUpdate: NoAction, map: "fk_pv_talle")

  @@unique([producto_id, talle_id, color_id], map: "ux_prod_talle_color")
  @@index([color_id], map: "ix_var_color")
  @@index([producto_id, talle_id, color_id], map: "ix_var_combo")
  @@index([producto_id], map: "ix_var_prod")
  @@index([talle_id], map: "ix_var_talle")
  @@index([is_active], map: "ix_var_active")
}

model productos {
  id                 Int                  @id
  nombre             String
  descripcion        String?
  genero             Genero
  thumbnail          String?
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  updated_at         DateTime             @default(now()) @db.Timestamptz(6)
  delete_reason      String?
  deleted_at         DateTime?            @db.Timestamptz(6)
  deleted_by         String?
  is_active          Boolean              @default(true)
  producto_variantes producto_variantes[]
  reservas           reservas[]

  @@index([is_active], map: "ix_productos_active")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model reservas {
  id            BigInt    @id @default(autoincrement())
  producto_id   Int
  talle_id      BigInt?
  color_id      BigInt
  cantidad      Int
  estado        String
  fecha_reserva DateTime  @default(now()) @db.Timestamptz(6)
  created_at    DateTime  @default(now()) @db.Timestamptz(6)
  updated_at    DateTime  @default(now()) @db.Timestamptz(6)
  delete_reason String?
  deleted_at    DateTime? @db.Timestamptz(6)
  deleted_by    String?
  is_active     Boolean   @default(true)
  colores       colores   @relation(fields: [color_id], references: [id], onUpdate: NoAction)
  productos     productos @relation(fields: [producto_id], references: [id], onUpdate: NoAction)
  talles        talles?   @relation(fields: [talle_id], references: [id], onUpdate: NoAction)

  @@index([is_active], map: "ix_reservas_active")
  @@index([fecha_reserva], map: "ix_reservas_fecha")
}

model talles {
  id                 BigInt               @id @default(autoincrement())
  nombre_talle       String               @unique(map: "talles_label_key")
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  updated_at         DateTime             @default(now()) @db.Timestamptz(6)
  deleted_at         DateTime?            @db.Timestamptz(6)
  is_active          Boolean              @default(true)
  deleted_by         String?
  delete_reason      String?
  producto_variantes producto_variantes[]
  reservas           reservas[]

  @@index([is_active], map: "ix_talles_active")
}

enum Genero {
  mujer
  hombre
  ni_os_unisex @map("ni√±os unisex")

  @@map("genero")
}
